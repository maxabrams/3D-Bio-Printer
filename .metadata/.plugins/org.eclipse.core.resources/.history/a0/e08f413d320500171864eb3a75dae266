import java.awt.Component;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.IOException;

import javax.swing.JButton;
import javax.swing.JPanel;
import javax.swing.JSlider;
import javax.swing.SpinnerNumberModel;
import javax.swing.event.ChangeEvent;
import javax.swing.event.ChangeListener;

public class LightingPanel {
	private JPanel lightPanel; // Panel to make modifications to
	private String lightName; // Name for panel
	private JButton setButton;
	private final String LIGHTING_BUTTON_TEXT = "Toggle Lights";
	private boolean isOn = false;
	private static final String PATH_TO_RELAY_OFF = "/home/pi/py/relay_off.py"; //Should be old code
	private static final String PATH_TO_RELAY_ON = "/home/pi/py/relay_on.py"; //Should be old code
	private JSlider redSlider;
	private JSlider blueSlider;
	private JSlider greenSlider;
	private Component redBox;
	private Component blueBox;
	private Component greenBox;
	

	public LightingPanel() {
		// Initialize components
		lightPanel = new JPanel();
		lightPanel.setLayout(new GridLayout(3, 2)); // Add a layout manager to align componenets
		
		lightName = "Lighting Control"; // Assign name

		// Setup sliders
		redSlider = new JSlider(0,255);
		blueSlider = new JSlider(0,255);
		greenSlider = new JSlider(0,255);
		
		//Set paint components
		redSlider.setPaintTicks(true);
		blueSlider.setPaintTicks(true);
		greenSlider.setPaintTicks(true);
		
		redSlider.setMinorTickSpacing(5);
		blueSlider.setMinorTickSpacing(5);
		greenSlider.setMinorTickSpacing(5);
		
		redSlider.setMajorTickSpacing(10);
		blueSlider.setMajorTickSpacing(10);
		greenSlider.setMajorTickSpacing(10);
		
		
		redBox = new SpinnerNumberModel(redSlider.getValue(), 0, 255, 1); //value, min, max, step
		blueBox = new SpinnerNumberModel(blueSlider.getValue(), 0, 255, 1);
		greenBox = new SpinnerNumberModel(greenSlider.getValue(), 0, 255, 1);
		
		
		//Add update listeners to sliders
		redSlider.addChangeListener(new ChangeListener(){

			@Override
			public void stateChanged(ChangeEvent e) {
				redBox.setValue(redSlider.getValue());
				
			}
			
		});
		
		blueSlider.addChangeListener(new ChangeListener(){

			@Override
			public void stateChanged(ChangeEvent e) {
				blueBox.setValue(blueSlider.getValue());
				
			}
			
		});
		
		greenSlider.addChangeListener(new ChangeListener(){

			@Override
			public void stateChanged(ChangeEvent e) {
				greenBox.setValue(greenSlider.getValue());
				
			}
			
		});
		
		//Add listeners to box
		redBox.addChangeListener(new ChangeListener(){

			@Override
			public void stateChanged(ChangeEvent e) {
				redSlider.setValue((int) (redBox.getValue()));
				
			}
			
		});
		
		blueBox.addChangeListener(new ChangeListener(){

			@Override
			public void stateChanged(ChangeEvent e) {
				blueSlider.setValue((int) (blueBox.getValue()));
				
			}
			
		});
		
		greenBox.addChangeListener(new ChangeListener(){

			@Override
			public void stateChanged(ChangeEvent e) {
				greenSlider.setValue((int) (greenBox.getValue()));
				
			}
			
		});
		
		//Add "set" button
		setButton = new JButton(LIGHTING_BUTTON_TEXT);
		setButton.addActionListener(new ActionListener() {

			@Override
			public void actionPerformed(ActionEvent e) {
				// TODO Auto-generated method stub
				

			} // Add action listener to respond to button

		});
		/*
		 * new JSlider(0,100); captureButton.setPaintTicks(true);
		 * captureButton.setMajorTickSpacing(10);
		 * captureButton.setMinorTickSpacing(5);
		 * captureButton.setPaintLabels(true);
		 */

		//Add components in draw order
		lightPanel.add(redSlider);
		lightPanel.add(blueSlider);
		lightPanel.add(greenSlider);
		lightPanel.add(redBox);
		lightPanel.add(blueBox);
		lightPanel.add(greenBox);
	}

	public JPanel getPanel() {
		return this.lightPanel;
	}

	public String getPanelName() {
		return lightName;
	}
}

/**
*
*Legacy code (can remove when LEDs are switched)
*try {
					if (isOn) {
						isOn = false;
						Process lOn = Runtime.getRuntime().exec(
								"sudo python " + PATH_TO_RELAY_OFF + " " + 21);
					} else {
						isOn = true;
						Process lOn = Runtime.getRuntime().exec(
								"sudo python " + PATH_TO_RELAY_ON + " " + 21);
					}
				} catch (IOException e1) {
					e1.printStackTrace();
				}
**/
